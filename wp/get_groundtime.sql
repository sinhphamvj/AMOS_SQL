SELECT
    wpno_i,
    wpno,
    ac_registr AS "AC_REG",
    station AS "STATION",
    TO_CHAR(DATE '1971-12-31' + start_date, 'DD.MON.YYYY') AS "START_DATE",
    TO_CHAR(TIME '00:00' + (start_time || ' minutes')::interval, 'HH24:MI') AS "START_TIME",
    TO_CHAR(DATE '1971-12-31' + end_date, 'DD.MON.YYYY') AS "END_DATE",
    TO_CHAR(TIME '00:00' + (end_time || ' minutes')::interval, 'HH24:MI') AS "END_TIME",
    TO_CHAR(TIME '00:00' + (
        CASE 
            WHEN end_time < start_time THEN (end_time + 1440) - start_time
            ELSE end_time - start_time
        END || ' minutes')::interval, 'HH24:MI') AS "GROUND_TIME",
    remarks AS "REMARKS"
FROM
    wp_header
WHERE
    wp_header.wpno_i IN (
        67216, 67096, 68538, 69192, 68103, 67928, 69193, 67197, 67230, 67183,
        67077, 67078, 69194, 67297, 67212, 67586, 67222, 68552, 68101, 67973,
        69197, 67485, 69195, 69198, 69200, 67589, 67195, 67547, 69201, 69202,
        68291, 69204, 68554, 67206, 67577, 67239, 67563, 67828, 67241, 67546,
        67296, 67566, 69211, 67607, 67218, 67352, 67300, 69213, 67570, 69215,
        68898, 69214, 67609, 68270, 69203, 67090, 68540, 67196, 67288, 67263,
        67719, 69207, 67301, 69218, 69219, 67776, 69217, 67596, 67290, 68549,
        67638, 67983, 67982, 68036, 67610, 68294, 67341, 69222, 67318, 67474,
        67084, 67578, 67711, 67623, 67603, 67367, 67258, 67756, 69221, 68065,
        67083, 67209, 66896, 68354, 67365, 67625, 67618, 67863, 67094, 69196,
        69206, 66757, 67964, 67089, 66918, 67400, 67971, 67720, 67321, 67479,
        67198, 67092, 67278, 66903, 66897, 67269, 67347, 67371, 67359, 67990,
        67985, 66876, 67967, 67965, 67348, 67868, 67591, 67235, 67234, 69216,
        67200, 67595, 67243, 67202, 67100, 67264, 67093, 66878, 66913, 69223,
        67594, 69220, 67597, 69205, 67098, 67095, 66882, 66895, 69224, 67627,
        69225, 66917, 66889, 66877, 69226, 69227, 66890, 69228, 66906, 67076,
        66904, 67630, 67606, 67248, 66818, 67246, 67245, 67075, 68899, 67244,
        68278, 68902, 66902, 67285, 67229, 67199, 66868, 66901, 67140, 67213,
        66934, 66932, 67159, 67790, 67141, 67204, 67238, 67165, 67355, 67403,
        67977, 67142, 67211, 68037, 67562, 66915, 67223, 67146, 67219, 67158,
        67151, 67143, 67203, 67324, 67323, 67310, 67252, 67250, 66963, 66888,
        66940, 66929, 66949, 66892, 66887, 66952, 66970, 67208, 67152, 67147,
        66907, 66966, 66937, 66965, 67306, 66875, 66978, 66972, 67608, 66785,
        67153, 67792, 67164, 66973, 66983, 67150, 67157, 67154, 67149, 67148,
        67155, 67404, 67327, 67366, 67362, 67309, 67331, 67593, 67633, 67579,
        67634, 67156, 67330, 66980, 67307, 67735, 66969, 66975, 67308, 67255,
        67332, 67302, 67339, 67257, 67161, 67380, 67205, 67072, 66984, 67304,
        67334, 67242, 67295, 67353, 67319, 66994, 66991, 66764, 67215, 67201,
        66990, 66993, 66995, 67599, 67345, 67406, 66796, 66814, 66806, 66766,
        66756, 66815, 67170, 67144, 67210, 67086, 67136, 67641, 66880, 66997,
        67081, 66812, 66992, 67079, 67343, 67217, 67344, 67764, 66810, 66817,
        66805, 66987, 66957, 67194, 67224, 67644, 67283, 67005, 67615, 66967,
        67254, 66819, 66821, 67373, 67062, 67407, 67002, 67099, 66942, 68941,
        66842, 66845, 66832, 66830, 66831, 66824, 66825, 67003, 67007, 67074,
        66988, 67259, 66843, 66827, 67171, 67305, 67260, 66835, 67237, 67004,
        67320, 66828, 66725, 67082, 67021, 66858, 66856, 66836, 66855, 66999,
        66857, 67009, 67020, 67172, 66864, 67010, 66854, 66851, 66859, 66837,
        67008, 67017, 66860, 66852, 66838, 67145, 67298, 67280, 66848, 67035,
        67029, 67038, 67032, 67175, 67039, 67645, 66861, 67173, 66839, 67265,
        67394, 67317, 66849, 67014, 67030, 67374, 67408, 67647, 66840, 66862,
        66841, 67293, 66863, 67031, 66879, 67037, 66927, 67047, 67044, 67040,
        67041, 66867, 67177, 66865, 67186, 67052, 67182, 67091, 67179, 67178,
        67181, 67049, 67268, 67043, 66961, 67185, 67137, 66866, 67160, 67188,
        67045, 67053, 67018, 67261, 67262, 67273, 67275, 67314, 67430, 67435,
        66870, 67026, 67649, 67270, 66869, 66872, 67063, 67068, 67058, 67055,
        67066, 67023, 67061, 67726, 66871, 67057, 67059, 67006, 67637, 68125,
        67739, 67636, 67189, 67247, 67337, 67272, 66873, 67274, 67069, 67064,
        67313, 67282, 67402, 67363, 67377, 67191, 68546, 67650, 67054, 67174,
        67087, 67176, 66874, 66928, 67067, 67060, 67757, 67794, 67042, 67279,
        67294, 67387, 67382, 67376, 67385, 67652, 67251, 67651, 67842, 67732,
        68532, 67758, 67775, 68075, 68249, 67835, 67836, 68136, 67840, 67734,
        67767, 67841, 67741, 67731, 67233, 67590, 67600, 67434, 67379, 67692,
        67643, 67653, 67621, 67677, 67669, 67654, 67716, 67742, 67655, 67797,
        67733, 67718, 67796, 67284, 67240, 67249, 67253, 67289, 67315, 67299,
        67368, 67384, 67614, 67449, 67613, 67657, 67670, 67656, 67715, 67777,
        67714, 67624, 67676, 68248, 68251, 67704, 67827, 67370, 67461, 67421,
        67388, 67463, 67438, 67356, 67364, 67349, 67361, 67415, 67460, 67443,
        67442, 67659, 68266, 68253, 67661, 67666, 67662, 67660, 67389, 68258,
        67342, 67441, 67464, 67469, 67383, 67395, 67372, 67470, 67473, 68577,
        67665, 67685, 67476, 67664, 67426, 67617, 67292, 67472, 67399, 67431,
        67462, 67748, 67751, 67746, 67168, 67369, 67445, 67401, 67471, 67484,
        67480, 67482, 67468, 67481, 67475, 67419, 67405, 67450, 67409, 67486,
        67488, 67478, 68609, 68055, 67412, 67417, 67381, 67392, 67416, 67723,
        67808, 67753, 67744, 67807, 67806, 67803, 67811, 67765, 67810, 67747,
        67802, 67674, 67398, 67667, 67418, 67375, 67413, 67424, 67411, 67386,
        67393, 67850, 67851, 68107, 67752, 67762, 67772, 67805, 67852, 67853,
        67616, 68054, 67396, 67378, 67423, 67391, 67414, 67422, 67446, 67447,
        67448, 67410, 68081, 67722, 68252, 67820, 67766, 67795, 67759, 67812,
        67489, 68042, 67492, 67490, 67494, 68123, 67684, 67784, 67679, 67681,
        67686, 67683, 67682, 67818, 67823, 67786, 67783, 67724, 67824, 68049,
        67502, 67503, 67505, 67507, 67509, 67511, 67516, 67497, 67500, 67499,
        67496, 67495, 67498, 67508, 67781, 67713, 67778, 67520, 68129, 67598,
        67694, 67693, 67582, 67639, 67697, 67626, 67585, 67628, 67632, 67691,
        67602, 67690, 67698, 67619, 67689, 67696, 67695, 67526, 67533, 67541,
        67534, 67536, 67540, 67523, 67531, 67529, 67583, 67521, 67530, 67524,
        67525, 67535, 67527, 67537, 67584, 67561, 67554, 67560, 67544, 67557,
        67565, 67559, 67558, 67564, 67549, 67552, 67551, 67548, 67556, 67699,
        67846, 67712, 67706, 67539, 67569, 67555, 67506, 67518, 67519, 67493,
        67088, 67568, 67572, 67550, 67573, 67629, 67745, 67793, 67870, 67532,
        67576, 67571, 67738, 67837, 68084, 67769, 67779, 67822, 67847, 67754,
        67728, 67771, 67780, 67791, 67815, 67737, 67782, 68948, 67968, 68076,
        68106, 68255, 68078, 68072, 68051, 68044, 68062, 68068, 68091, 68067,
        68135, 68268, 68949, 67874, 67866, 67890, 68137, 67891, 67855, 67876,
        67878, 67880, 67885, 67975, 67988, 68265, 68040, 68257, 68086, 68256,
        67910, 67898, 67899, 68108, 67913, 67901, 67896, 67903, 67821, 67736,
        68048, 68041, 67947, 68073, 68117, 67917, 67849, 67867, 67916, 67857,
        67858, 67774, 67838, 67798, 67729, 67760, 67915, 67862, 67872, 67860,
        68236, 68077, 67800, 67816, 67934, 67922, 67814, 68568, 67927, 67926,
        67923, 67930, 67933, 67932, 67854, 67833, 67929, 67740, 68079, 67907,
        67861, 67937, 67787, 67879, 67951, 67925, 67938, 67892, 67906, 67944,
        67894, 67935, 68092, 67864, 67875, 67883, 67869, 67897, 67946, 67953,
        67940, 67912, 67889, 67954, 68098, 68097, 68056, 68043, 67865, 68237,
        68060, 68063, 68887, 68883, 67871, 68957, 68952, 67976, 67962, 67957,
        67980, 68110, 68114, 68259, 68095, 68263, 68109, 68953, 68069, 68087,
        68046, 68083, 68594, 68934, 68111, 68947, 68956, 68895, 68128, 68241,
        68050, 68130, 68082, 68954, 68260, 68134, 68939, 68893, 68529, 68509,
        68595, 68516, 68589, 68039, 67986, 67905, 67948, 67943, 67989, 68105,
        67902, 68240, 68070, 68058, 68090, 68061, 68074, 68094, 68269, 68261,
        68112, 68242, 68553, 68919, 68520, 68526, 68247, 68283, 68515, 68575,
        68910, 68285, 68896, 68892, 68877, 68605, 68876, 68882, 68599, 68313,
        68506, 68300, 68891, 68307, 68533, 68527, 68912, 68321, 68940, 68293,
        68304, 68832, 68406, 68542, 68312, 68849, 68522, 68836, 68652, 68653,
        68724, 68850, 68904, 68945, 68507, 68306, 68913, 68298, 68303, 68900,
        68935, 68607, 68610, 68924, 68299, 68573, 68884, 68960, 68580, 68894,
        68964, 68667, 68878, 68295, 68612, 68318, 68311, 68928, 68911, 68930,
        68551, 68319, 68566, 68613, 68584, 68317, 68922, 68921, 68927, 68301,
        68702, 68659, 68292, 68274, 68322, 68279, 68332, 68250, 68281, 68333,
        68327, 68331, 68334, 68346, 68290, 68038, 68100, 68262, 68328, 68282,
        68275, 68342, 68329, 68140, 68335, 68324, 68286, 68314, 67969, 68932,
        68360, 68357, 68289, 68353, 68349, 68244, 68355, 68243, 68277, 68351,
        68375, 68367, 68886, 68888, 68946, 68372, 68362, 68370, 68338, 68365,
        68348, 68356, 68374, 68363, 68352, 68340, 67065, 68391, 68545, 68377,
        68379, 68392, 68808, 68390, 68387, 68543, 68389, 68385, 68271, 68534,
        68398, 68399, 68394, 68395, 68401, 68955, 68918, 68397, 68933, 68909,
        68942, 68880, 68961, 68671, 68272, 68916, 68926, 68929, 68620, 68640,
        68539, 68636, 68408, 68407, 68411, 68920, 68989, 68925, 68990, 68907,
        68969, 68903, 68971, 68991, 68986, 68987, 68975, 68412, 68410, 68405,
        68973, 68988, 68968, 68993, 68976, 68718, 68645, 68970, 68992, 68643,
        68649, 68650, 69000, 68977, 68998, 68959, 69005, 68996, 68951, 68943,
        68979, 68646, 68414, 69006, 68409, 69003, 68978, 68974, 68596, 68424,
        68427, 68555, 69036, 68433, 68418, 69004, 68422, 68419, 68429, 68434,
        68980, 68435, 68881, 69038, 68417, 68457, 68446, 68447, 68451, 68440,
        68448, 68444, 68981, 68455, 68441, 68453, 69037, 69039, 68386, 68378,
        68384, 68462, 68382, 68466, 68982, 68467, 68460, 68464, 68288, 68245,
        68463, 68393, 69049, 68459, 68461, 68431, 68437, 68579, 68485, 68472,
        68488, 68470, 68471, 68479, 68468, 68484, 68486, 68983, 69041, 69062,
        68492, 68500, 69042, 68478, 68504, 68493, 68497, 69044, 68496, 69063,
        68503, 68450, 68477, 68423, 68426, 68505, 68432, 68449, 68420, 68443,
        68482, 69069, 68421, 68530, 68569, 68559, 68556, 68531, 68547, 68557,
        68558, 68905, 68623, 69065, 69070, 68541, 68582, 68544, 68578, 68654,
        68618, 68535, 68536, 68570, 68638, 68592, 68611, 68590, 69066, 68587,
        68483, 68591, 68514, 68639, 68581, 68473, 68517, 68600, 68602, 68603,
        68593, 68597, 68598, 68343, 68528, 68513, 68565, 69043, 68521, 68588,
        69073, 69082, 69078, 69080, 69068, 69083, 68567, 68997, 69091, 69092,
        68950, 69055, 68914, 68999, 69093, 69094, 69057, 68995, 69089, 68512,
        69088, 68615, 68508, 69085, 69001, 68576, 68730, 69106, 69105, 68684,
        68680, 68985, 68931, 69054, 69102, 69100, 69095, 69086, 69101, 69097,
        69064, 69081, 69060, 69103, 69075, 68644, 68708, 68673, 68525, 68621,
        69074, 69072, 68732, 68700, 69046, 69077, 68984, 69071, 68585, 69096,
        68731, 68707, 69076, 68709, 68695, 69051, 69084, 68692, 69079, 68715,
        69050, 69067, 68711, 68698, 68683, 68720, 69111, 69109, 68721, 68661,
        68656, 69112, 68719, 69110, 69108, 69114, 68727, 69115, 68124, 68726,
        68662, 68712, 69121, 69119, 68725, 68685, 68734, 68735, 69148, 68704,
        69150, 68677, 68713, 69149, 69153, 69154, 68736, 68672, 69130, 68669,
        68678, 68658, 68670, 69155, 69131, 69143, 69147, 69139, 69151, 68693,
        68674, 68728, 68642, 68664, 68681, 68679, 68773, 68765, 68523, 68717,
        68562, 69126, 69122, 69118, 69120, 69129, 68696, 68733, 68688, 68706,
        68682, 68766, 68729, 68771, 68687, 69127, 69141, 69128, 69133, 69144,
        69140, 69132, 68703, 68583, 68676, 69138, 68660, 69123, 69142, 69152,
        69145, 69124, 68751, 68774, 68843, 69134, 69146, 68694, 68657, 68510,
        68705, 68741, 68699, 68748, 68690, 68749, 68742, 68743, 68722, 68647,
        68747, 68755, 68739, 68761, 68776, 69135, 69158, 69156, 69159, 69173,
        69163, 69181, 68756, 68561, 68768, 68757, 69157, 68779, 69136, 69160,
        69182, 68780, 69161, 69171, 69183, 68789, 68792, 69162, 69166, 69178,
        69179, 69165, 69184, 69168, 68800, 68796, 68802, 68801, 68799, 68804,
        68783, 68793, 68787, 69185, 69167, 68811, 68815, 68813, 68777, 68809,
        68778, 68803, 69186, 69169, 68826, 68820, 68816, 68829, 69180, 68823,
        69170, 69189, 68814, 68604, 68824, 68821, 68781, 68825, 68750, 68863,
        68828, 68840, 68870, 68834, 68873, 68872, 68874, 68871, 68868, 69174,
        69188, 69175, 69190, 69172, 68791, 68752, 68762, 68769, 68767, 68772,
        68758, 68763, 68770, 68759, 68798, 68812, 68754, 68753, 68788, 68760,
        69176, 68854, 68861, 68784, 68858, 68860, 68862, 68746, 68846, 68830,
        68853, 68797, 68852, 68864, 68856, 68867, 68844, 69177, 68865, 69191
    )
    AND wp_header.ac_registr NOT IN (
      SELECT
         mdr.ac_registr
      FROM
         moc_daily_records mdr
      WHERE
         mdr.event_group IN ('DLYRP')
         AND mdr.closed <> 'Y'
         AND mdr.event_type IN (
            'C_CHK',
            'A_CHK',
            'O_CHK',
            'PK_MT',
            'ST_MT',
            'AOG'
         )
    )

ORDER BY
    CASE
        WHEN wp_header.station = 'SGN' THEN 1
        WHEN wp_header.station = 'HAN' THEN 2
        WHEN wp_header.station = 'DAD' THEN 3
        WHEN wp_header.station = 'CXR' THEN 4
        WHEN wp_header.station = 'HPH' THEN 5
        WHEN wp_header.station = 'VII' THEN 6
        WHEN wp_header.station = 'VCA' THEN 7
        WHEN wp_header.station = 'PQC' THEN 8
        ELSE 9
    END,
    wp_header.ac_registr